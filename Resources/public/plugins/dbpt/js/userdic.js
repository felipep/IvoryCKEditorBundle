var spellUrl='../';var cp=new cpaint();cp.set_transfer_mode('post');cp.set_response_type('text');var langNames=new Array();langNames[0]='neutr';langNames[1]='de';langNames[2]='ch';langNames[3]='at';langNames[4]='en';langNames[5]='gb';langNames[6]='us';langNames[7]='sp';langNames[8]='it';langNames[9]='fr';var dict=new Array();dict['neutr']=new Array();dict['de']=new Array();dict['ch']=new Array();dict['at']=new Array();dict['en']=new Array();dict['gb']=new Array();dict['us']=new Array();dict['sp']=new Array();dict['it']=new Array();dict['fr']=new Array();var dictLoaded=new Array();dictLoaded['neutr']=false;dictLoaded['de']=false;dictLoaded['ch']=false;dictLoaded['at']=false;dictLoaded['en']=false;dictLoaded['gb']=false;dictLoaded['us']=false;dictLoaded['sp']=false;dictLoaded['it']=false;dictLoaded['fr']=false;var dirtyFlag=new Array();dirtyFlag['neutr']=false;dirtyFlag['de']=false;dirtyFlag['ch']=false;dirtyFlag['at']=false;dirtyFlag['en']=false;dirtyFlag['gb']=false;dirtyFlag['us']=false;dirtyFlag['sp']=false;dirtyFlag['it']=false;dirtyFlag['fr']=false;var currLang=null;var currItem=null;var maxItemId=0;function myCompare(a,b){var s1=a.toString();var s2=b.toString();var retval=0;try{retval=s1.toLocaleLowerCase().localeCompare(s2.toLocaleLowerCase())}catch(e){if(s1.toLocaleLowerCase()<s2.toLocaleLowerCase()){retval=-1}else if(s1.toLocaleLowerCase()>s2.toLocaleLowerCase()){retval=1}else{retval=0}}return retval}function initDict(){var langElement=document.getElementById('lang');currLang='neutr';document.getElementById("buttonSave").disabled=true;currLang=config['lang'];langElement.value=currLang;loadDict()}function loadDict(){if(dictLoaded[currLang]==false){document.getElementById('status').innerHTML='Laden...';cp.call(spellUrl+'spell.php','dpfws_load_user_dict',loadDict_cb,currLang);dictLoaded[currLang]=true}else{updateDialog()}}function loadDict_cb(retval){if(retval.length!=0){dict[currLang]=retval.split('~~~~');dict[currLang].sort(myCompare)}document.getElementById('status').innerHTML='';updateDialog()}function saveDict(){var i;var statusElement=document.getElementById('status');for(i=0;i<langNames.length;i++){if(dirtyFlag[langNames[i]]){statusElement.innerHTML='Speichern '+langNames[i]+'...';cp.call(spellUrl+'spell.php','dpfws_save_user_dict',saveDict_cb,langNames[i],dict[langNames[i]].join('~~~~'));break}}}function saveDict_cb(retval){var i;var anyDirty=false;var statusElement=document.getElementById('status');dirtyFlag[retval]=false;for(i=0;i<langNames.length;i++){if(dirtyFlag[langNames[i]]){statusElement.innerHTML='Speichern '+langNames[i]+'...';anyDirty=true;cp.call(spellUrl+'spell.php','dpfws_save_user_dict',saveDict_cb,langNames[i],dict[langNames[i]].join('~~~~'));break}}if(!anyDirty){statusElement.innerHTML='';document.getElementById("buttonSave").disabled=true}}function updateDialog(){var dictElement=document.getElementById('dict');var i;while(dictElement.firstChild){dictElement.removeChild(dictElement.firstChild)}maxItemId=0;currItem=null;for(i=0;i<dict[currLang].length;i++){addRow(dict[currLang][i])}}function selectWord(e){var theTarget=getTarget(e);if(currItem!=null){currItem.parentNode.style.backgroundColor="#ffffff"}currItem=theTarget;currItem.parentNode.style.backgroundColor="#ffff99"}function addWord(){var wordElement=document.getElementById('word');var s;var i;s=trim(wordElement.value);if(s.length==0)return;i=s.indexOf(' ');if(i!=-1){s=s.substr(0,i);wordElement.value=s}for(i=0;i<dict[currLang].length;i++){if(dict[currLang][i]==s)return}dict[currLang].push(s);dict[currLang].sort(myCompare);updateDialog();dirtyFlag[currLang]=true;document.getElementById("buttonSave").disabled=false}function addRow(word){var dictElement=document.getElementById('dict');var rowElement;var itemElement;var i=maxItemId++;rowElement=document.createElement('div');rowElement.id='row'+i;rowElement.className='dialog_row';itemElement=document.createElement('div');itemElement.id='item'+i;itemElement.className='userdic_item';itemElement.onclick=selectWord;itemElement.innerHTML=word;dictElement.appendChild(rowElement);rowElement.appendChild(itemElement)}function deleteWord(){var rowElement;var i;var s;if(currItem!=null){s=currItem.innerHTML;for(i=0;i<dict[currLang].length;i++){if(dict[currLang][i]==s){dict[currLang].splice(i,1);break}}rowElement=currItem.parentNode;rowElement.parentNode.removeChild(rowElement);currItem=null;dirtyFlag[currLang]=true;document.getElementById("buttonSave").disabled=false}}function langOnChange(){var langElement=document.getElementById('lang');currLang=langElement.value;loadDict()}function closeOnClick(){var i;var anyDirty=false;for(i=0;i<langNames.length;i++){if(dirtyFlag[langNames[i]]){anyDirty=true;break}}if(anyDirty){if(!window.confirm(loc.loc022)){return}}var CKEDITOR=window.parent.CKEDITOR;CKEDITOR.dialog.getCurrent().fire("ok");CKEDITOR.dialog.getCurrent().hide()}function getTarget(e){var value;if(checkBrowser()=="ie"){value=window.event.srcElement}else{value=e.target}return value}function checkBrowser(){var theAgent=navigator.userAgent.toLowerCase();if(theAgent.indexOf("msie")!=-1){if(theAgent.indexOf("opera")!=-1){return"opera"}else{return"ie"}}else if(theAgent.indexOf("netscape")!=-1){return"netscape"}else if(theAgent.indexOf("firefox")!=-1){return"firefox"}else if(theAgent.indexOf("mozilla/5.0")!=-1){return"mozilla"}else if(theAgent.indexOf("\/")!=-1){if(theAgent.substr(0,theAgent.indexOf('\/'))!='mozilla'){return navigator.userAgent.substr(0,theAgent.indexOf('\/'))}else{return"netscape"}}else if(theAgent.indexOf(' ')!=-1){return navigator.userAgent.substr(0,theAgent.indexOf(' '))}else{return navigator.userAgent}}function trim(s){while(s.substring(0,1)==' '){s=s.substring(1,s.length)}while(s.substring(s.length-1,s.length)==' '){s=s.substring(0,s.length-1)}return s}